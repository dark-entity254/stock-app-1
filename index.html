<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="manifest" href="manifest.json">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('sw.js');
  }
</script>
    let alertTarget = null;

async function enableNotifications() {
    const permission = await Notification.requestPermission();
    if (permission === "granted") {
        alertTarget = parseFloat(document.getElementById('alertPrice').value);
        document.getElementById('notifyBtn').innerText = "ALERT ACTIVE: $" + alertTarget;
        document.getElementById('notifyBtn').style.background = "#39ff14";
        
        // Start watching the price
        startPriceWatcher();
    } else {
        alert("Permission denied. Enable notifications in your browser settings.");
    }
}

function startPriceWatcher() {
    // Check every 30 seconds
    setInterval(async () => {
        if (!alertTarget) return;

        const symbol = document.getElementById('ticker').value.toUpperCase();
        if (!symbol) return;

        const apiKey = 'YOUR_API_KEY';
        const res = await fetch(`https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol=${symbol}&apikey=${apiKey}`);
        const data = await res.json();
        const currentPrice = parseFloat(data['Global Quote']['05. price']);

        if (currentPrice >= alertTarget) {
            sendNotification(symbol, currentPrice);
            alertTarget = null; // Reset after alert
            document.getElementById('notifyBtn').innerText = "SET ALERT";
            document.getElementById('notifyBtn').style.background = "var(--gold)";
        }
    }, 30000); 
}

function sendNotification(symbol, price) {
    if (Notification.permission === "granted") {
        navigator.serviceWorker.ready.then(registration => {
            registration.showNotification(`TRADING ALERT: ${symbol}`, {
                body: `Target Hit! Current Price: $${price.toFixed(2)}`,
                icon: 'icon.png'
            });
        });
    }
}
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DIM3Z & DOZ3NZ - Trader Pro</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root { --neon-green: #39ff14; --neon-red: #ff3131; --neon-cyan: #00ffff; --gold: #ffd700; --bg: #0a0f1a; }
        body {
            margin: 0; padding: 20px; background: url('background.png') no-repeat center center fixed;
            background-size: cover; color: white; font-family: 'Inter', sans-serif;
            display: flex; justify-content: center;
        }
        .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(10, 15, 26, 0.85); z-index: -1; }
        .app-container { width: 100%; max-width: 500px; z-index: 10; }
        
        /* Header */
        .header { text-align: center; margin-bottom: 20px; }
        .header h1 { color: var(--gold); margin: 0; text-shadow: 0 0 10px var(--gold); font-size: 1.6rem; }
        .header p { color: var(--neon-cyan); margin: 5px 0; font-size: 0.8rem; letter-spacing: 2px; }

        /* Search */
        .search-box { display: flex; gap: 10px; margin-bottom: 20px; }
        input { flex: 1; background: rgba(255,255,255,0.05); border: 1px solid var(--neon-cyan); padding: 12px; border-radius: 8px; color: white; }
        button { background: var(--gold); border: none; padding: 0 20px; border-radius: 8px; font-weight: bold; cursor: pointer; }

        /* Main Display */
        .main-display { background: rgba(255,255,255,0.03); padding: 20px; border-radius: 15px; border: 1px solid rgba(255,215,0,0.3); margin-bottom: 20px; }
        .price { font-size: 3.5rem; font-weight: 800; color: var(--neon-green); text-align: center; margin: 10px 0; }
        
        /* Intelligence Panel */
        .intel-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px; }
        .intel-card { background: rgba(0,0,0,0.4); padding: 15px; border-radius: 10px; border-left: 3px solid var(--neon-cyan); }
        .intel-card small { color: #94a3b8; font-size: 0.7rem; display: block; margin-bottom: 5px; }
        .intel-card span { font-size: 1.1rem; font-weight: bold; color: white; }
        .signal-buy { color: var(--neon-green) !important; }
        .signal-sell { color: var(--neon-red) !important; }

        #clock { text-align: center; margin-top: 20px; font-family: monospace; color: var(--neon-cyan); font-size: 1.2rem; }
    </style>
</head>
<body>
    <div class="overlay"></div>
    <div class="app-container">
        <div class="header">
            <h1>DIM3Z & DOZ3NZ</h1>
            <p>EMMANUEL KING TERMINAL</p>
        </div>

        <div class="search-box">
            <input type="text" id="ticker" placeholder="ENTER SYMBOL (e.g. TSLA)">
            <button onclick="updateTerminal()">ANALYZER</button>
        </div>

        <div class="main-display">
            <div id="symbolName" style="text-align:center; color: var(--gold);">SECURE LINE IDLE</div>
            <div class="price" id="currentPrice">$0.00</div>
            <canvas id="traderChart"></canvas>
        </div>

        <div class="intel-grid">
            <div class="intel-card">
                <small>7-DAY MOMENTUM (RSI)</small>
                <span id="rsiValue">--</span>
            </div>
            <div class="intel-card">
                <small>VOLATILITY INDEX</small>
                <span id="volatility">--</span>
            </div>
            <div class="intel-card">
                <small>SMA (MOVING AVG)</small>
                <span id="smaValue">--</span>
            </div>
            <div class="intel-card">
                <small>MARKET SIGNAL</small>
                <span id="tradeSignal">WAITING...</span>
            </div>
        </div>
        <div class="intel-card" style="grid-column: span 2; border-left: 3px solid var(--gold);">
    <small>SET PRICE ALERT</small>
    <div style="display: flex; gap: 10px; margin-top: 5px;">
        <input type="number" id="alertPrice" placeholder="Target Price" style="padding: 5px;">
        <button onclick="enableNotifications()" id="notifyBtn" style="padding: 5px 10px; font-size: 0.7rem;">SET ALERT</button>
    </div>
</div>

        <div id="clock">00:00:00</div>
    </div>

    <script>
        function updateClock() {
            document.getElementById('clock').innerText = new Date().toLocaleTimeString();
            setTimeout(updateClock, 1000);
        }
        updateClock();

        let chart;
        async function updateTerminal() {
            const symbol = document.getElementById('ticker').value.toUpperCase();
            const apiKey = 'YOUR_API_KEY'; // ENTER YOUR KEY HERE
            
            try {
                const res = await fetch(`https://www.alphavantage.co/query?function=TIME_SERIES_DAILY&symbol=${symbol}&apikey=${apiKey}`);
                const data = await res.json();
                const ts = data['Time Series (Daily)'];
                const dates = Object.keys(ts).slice(0, 14).reverse();
                const prices = dates.map(d => parseFloat(ts[d]['4. close']));
                
                // DATA CALCULATIONS
                const latestPrice = prices[prices.length - 1];
                const avgPrice = prices.reduce((a, b) => a + b, 0) / prices.length;
                const rsi = ((latestPrice / prices[0]) * 50).toFixed(2); // Simplified RSI
                const volt = (Math.max(...prices) - Math.min(...prices)).toFixed(2);

                // UI UPDATE
                document.getElementById('symbolName').innerText = "LIVE ASSET: " + symbol;
                document.getElementById('currentPrice').innerText = "$" + latestPrice.toFixed(2);
                document.getElementById('rsiValue').innerText = rsi;
                document.getElementById('volatility').innerText = "$" + volt;
                document.getElementById('smaValue').innerText = "$" + avgPrice.toFixed(2);
                
                const signalEl = document.getElementById('tradeSignal');
                if(rsi > 55) { signalEl.innerText = "OVERBOUGHT"; signalEl.className = "signal-sell"; }
                else if(rsi < 45) { signalEl.innerText = "OVERSOLD (BUY)"; signalEl.className = "signal-buy"; }
                else { signalEl.innerText = "NEUTRAL"; signalEl.className = ""; }

                renderChart(dates, prices);
            } catch (e) { alert("Check Connection or API Limit"); }
        }

        function renderChart(labels, data) {
            const ctx = document.getElementById('traderChart').getContext('2d');
            if(chart) chart.destroy();
            chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels.map(l => l.split('-').slice(1).join('/')),
                    datasets: [{
                        label: 'Price',
                        data: data,
                        borderColor: '#ffd700',
                        borderWidth: 3,
                        backgroundColor: 'rgba(57, 255, 20, 0.1)',
                        fill: true,
                        tension: 0.3
                    }]
                },
                options: {
                    plugins: { legend: { display: false } },
                    scales: {
                        x: { ticks: { color: '#00ffff' }, grid: { display: false } },
                        y: { ticks: { color: '#00ffff' }, grid: { color: 'rgba(255,255,255,0.1)' } }
                    }
                }
            });
        }
    </script>
</body>
</html>
